/*! jQuery Address v1.6 | (c) 2009, 2013 Rostislav Hristov | jquery.org/license */
(function(c){typeof define==="function"&&define.amd?define(["jquery"],c):c(jQuery)})(function(c){c.address=function(){var s=function(a){a=c.extend(c.Event(a),function(){for(var b={},h=c.address.parameterNames(),m=0,q=h.length;m<q;m++)b[h[m]]=c.address.parameter(h[m]);return{value:c.address.value(),path:c.address.path(),pathNames:c.address.pathNames(),parameterNames:h,parameters:b,queryString:c.address.queryString()}}.call(c.address));c(c.address).trigger(a);return a},i=function(a){return Array.prototype.slice.call(a)},
k=function(){c().bind.apply(c(c.address),Array.prototype.slice.call(arguments));return c.address},ea=function(){c().unbind.apply(c(c.address),Array.prototype.slice.call(arguments));return c.address},G=function(){return A.pushState&&d.state!==e},T=function(){return("/"+n.pathname.replace(new RegExp(d.state),"")+n.search+(H()?"#"+H():"")).replace(S,"/")},H=function(){var a=n.href.indexOf("#");return a!=-1?n.href.substr(a+1):""},r=function(){return G()?T():H()},U=function(){try{return top.document!==
e&&top.document.title!==e&&top.jQuery!==e&&top.jQuery.address!==e&&top.jQuery.address.frames()!==false?top:window}catch(a){return window}},V=function(){return"javascript"},M=function(a){a=a.toString();return(d.strict&&a.substr(0,1)!="/"?"/":"")+a},t=function(a,b){return parseInt(a.css(b),10)},C=function(){if(!I){var a=r();if(decodeURI(g)!=decodeURI(a))if(v&&y<7)n.reload();else{v&&!J&&d.history&&u(N,50);g=a;B(o)}}},B=function(a){u(fa,10);return s(W).isDefaultPrevented()||s(a?X:Y).isDefaultPrevented()},
fa=function(){if(d.tracker!=="null"&&d.tracker!==D){var a=c.isFunction(d.tracker)?d.tracker:f[d.tracker],b=(n.pathname+n.search+(c.address&&!G()?c.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,"");if(c.isFunction(a))a(b);else{c.isFunction(f.urchinTracker)&&f.urchinTracker(b);f.pageTracker!==e&&c.isFunction(f.pageTracker._trackPageview)&&f.pageTracker._trackPageview(b);f._gaq!==e&&c.isFunction(f._gaq.push)&&f._gaq.push(["_trackPageview",decodeURI(b)]);c.isFunction(f.ga)&&f.ga("send","pageview",
b)}}},N=function(){var a=V()+":"+o+";document.open();document.writeln('<html><head><title>"+l.title.replace(/\'/g,"\\'")+"</title><script>var "+z+' = "'+encodeURIComponent(r()).replace(/\'/g,"\\'")+(l.domain!=n.hostname?'";document.domain="'+l.domain:"")+"\";<\/script></head></html>');document.close();";if(y<7)j.src=a;else j.contentWindow.location.replace(a)},$=function(){if(E&&Z!=-1){var a,b,h=E.substr(Z+1).split("&");for(a=0;a<h.length;a++){b=h[a].split("=");if(/^(autoUpdate|history|strict|wrap)$/.test(b[0]))d[b[0]]=
isNaN(b[1])?/^(true|yes)$/i.test(b[1]):parseInt(b[1],10)!==0;if(/^(state|tracker)$/.test(b[0]))d[b[0]]=b[1]}E=D}g=r()},ba=function(){if(!aa){aa=p;$();c('a[rel*="address:"]').address();if(d.wrap){var a=c("body");c("body > *").wrapAll('<div style="padding:'+(t(a,"marginTop")+t(a,"paddingTop"))+"px "+(t(a,"marginRight")+t(a,"paddingRight"))+"px "+(t(a,"marginBottom")+t(a,"paddingBottom"))+"px "+(t(a,"marginLeft")+t(a,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+z+'" style="height:100%;overflow:auto;position:relative;'+
(K&&!window.statusbar.visible?"resize:both;":"")+'" />');c("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"});K&&c('<style type="text/css" />').appendTo("head").text("#"+z+"::-webkit-resizer { background-color: #fff; }")}if(v&&!J){a=l.getElementsByTagName("frameset")[0];j=l.createElement((a?"":"i")+"frame");j.src=V()+":"+o;if(a){a.insertAdjacentElement("beforeEnd",j);a[a.cols?"cols":"rows"]+=",0";j.noResize=p;j.frameBorder=j.frameSpacing=0}else{j.style.display="none";j.style.width=
j.style.height=0;j.tabIndex=-1;l.body.insertAdjacentElement("afterBegin",j)}u(function(){c(j).bind("load",function(){var b=j.contentWindow;g=b[z]!==e?b[z]:"";if(g!=r()){B(o);n.hash=g}});j.contentWindow[z]===e&&N()},50)}u(function(){s("init");B(o)},1);if(!G())if(v&&y>7||!v&&J)if(f.addEventListener)f.addEventListener(F,C,o);else f.attachEvent&&f.attachEvent("on"+F,C);else ga(C,50);"state"in window.history&&c(window).trigger("popstate")}},ha=function(a){a=a.toLowerCase();a=/(chrome)[ \/]([\w.]+)/.exec(a)||
/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}},e,D=null,z="jQueryAddress",F="hashchange",W="change",X="internalChange",Y="externalChange",p=true,o=false,d={autoUpdate:p,history:p,strict:p,frames:p,wrap:o},w=function(){var a={},b=ha(navigator.userAgent);if(b.browser){a[b.browser]=true;a.version=b.version}if(a.chrome)a.webkit=true;
else if(a.webkit)a.safari=true;return a}(),y=parseFloat(w.version),K=w.webkit||w.safari,v=w.msie,f=U(),l=f.document,A=f.history,n=f.location,ga=setInterval,u=setTimeout,S=/\/{2,9}/g;w=navigator.userAgent;var J="on"+F in f,j,E=c("script:last").attr("src"),Z=E?E.indexOf("?"):-1,O=l.title,I=o,aa=o,ca=p,L=o,g=r();if(v){y=parseFloat(w.substr(w.indexOf("MSIE")+4));if(l.documentMode&&l.documentMode!=y)y=l.documentMode!=8?7:8;var da=l.onpropertychange;l.onpropertychange=function(){da&&da.call(l);if(l.title!=
O&&l.title.indexOf("#"+r())!=-1)l.title=O}}if(A.navigationMode)A.navigationMode="compatible";if(document.readyState=="complete")var ia=setInterval(function(){if(c.address){ba();clearInterval(ia)}},50);else{$();c(ba)}c(window).bind("popstate",function(){if(decodeURI(g)!=decodeURI(r())){g=r();B(o)}}).bind("unload",function(){if(f.removeEventListener)f.removeEventListener(F,C,o);else f.detachEvent&&f.detachEvent("on"+F,C)});return{bind:function(){return k.apply(this,i(arguments))},unbind:function(){return ea.apply(this,
i(arguments))},init:function(){return k.apply(this,["init"].concat(i(arguments)))},change:function(){return k.apply(this,[W].concat(i(arguments)))},internalChange:function(){return k.apply(this,[X].concat(i(arguments)))},externalChange:function(){return k.apply(this,[Y].concat(i(arguments)))},baseURL:function(){var a=n.href;if(a.indexOf("#")!=-1)a=a.substr(0,a.indexOf("#"));if(/\/$/.test(a))a=a.substr(0,a.length-1);return a},autoUpdate:function(a){if(a!==e){d.autoUpdate=a;return this}return d.autoUpdate},
history:function(a){if(a!==e){d.history=a;return this}return d.history},state:function(a){if(a!==e){d.state=a;var b=T();if(d.state!==e)if(A.pushState)b.substr(0,3)=="/#/"&&n.replace(d.state.replace(/^\/$/,"")+b.substr(2));else b!="/"&&b.replace(/^\/#/,"")!=H()&&u(function(){n.replace(d.state.replace(/^\/$/,"")+"/#"+b)},1);return this}return d.state},frames:function(a){if(a!==e){d.frames=a;f=U();return this}return d.frames},strict:function(a){if(a!==e){d.strict=a;return this}return d.strict},tracker:function(a){if(a!==
e){d.tracker=a;return this}return d.tracker},wrap:function(a){if(a!==e){d.wrap=a;return this}return d.wrap},update:function(){L=p;this.value(g);L=o;return this},title:function(a){if(a!==e){u(function(){O=l.title=a;if(ca&&j&&j.contentWindow&&j.contentWindow.document){j.contentWindow.document.title=a;ca=o}},50);return this}return l.title},value:function(a){if(a!==e){a=M(a);if(a=="/")a="";if(g==a&&!L)return;g=a;if(d.autoUpdate||L){if(B(p))return this;if(G())A[d.history?"pushState":"replaceState"]({},
"",d.state.replace(/\/$/,"")+(g===""?"/":g));else{I=p;if(K)if(d.history)n.hash="#"+g;else n.replace("#"+g);else if(g!=r())if(d.history)n.hash="#"+g;else n.replace("#"+g);v&&!J&&d.history&&u(N,50);if(K)u(function(){I=o},1);else I=o}}return this}return M(g)},path:function(a){if(a!==e){var b=this.queryString(),h=this.hash();this.value(a+(b?"?"+b:"")+(h?"#"+h:""));return this}return M(g).split("#")[0].split("?")[0]},pathNames:function(){var a=this.path(),b=a.replace(S,"/").split("/");if(a.substr(0,1)==
"/"||a.length===0)b.splice(0,1);a.substr(a.length-1,1)=="/"&&b.splice(b.length-1,1);return b},queryString:function(a){if(a!==e){var b=this.hash();this.value(this.path()+(a?"?"+a:"")+(b?"#"+b:""));return this}a=g.split("?");return a.slice(1,a.length).join("?").split("#")[0]},parameter:function(a,b,h){var m,q;if(b!==e){var P=this.parameterNames();q=[];b=b===e||b===D?"":b.toString();for(m=0;m<P.length;m++){var Q=P[m],x=this.parameter(Q);if(typeof x=="string")x=[x];if(Q==a)x=b===D||b===""?[]:h?x.concat([b]):
[b];for(var R=0;R<x.length;R++)q.push(Q+"="+x[R])}c.inArray(a,P)==-1&&b!==D&&b!==""&&q.push(a+"="+b);this.queryString(q.join("&"));return this}if(b=this.queryString()){h=[];q=b.split("&");for(m=0;m<q.length;m++){b=q[m].split("=");b[0]==a&&h.push(b.slice(1).join("="))}if(h.length!==0)return h.length!=1?h:h[0]}},parameterNames:function(){var a=this.queryString(),b=[];if(a&&a.indexOf("=")!=-1){a=a.split("&");for(var h=0;h<a.length;h++){var m=a[h].split("=")[0];c.inArray(m,b)==-1&&b.push(m)}}return b},
hash:function(a){if(a!==e){this.value(g.split("#")[0]+(a?"#"+a:""));return this}a=g.split("#");return a.slice(1,a.length).join("#")}}}();c.fn.address=function(s){c(this).each(function(){c(this).data("address")||c(this).on("click",function(i){if(i.shiftKey||i.ctrlKey||i.metaKey||i.which==2)return true;var k=i.currentTarget;if(c(k).is("a")){i.preventDefault();i=s?s.call(k):/address:/.test(c(k).attr("rel"))?c(k).attr("rel").split("address:")[1].split(" ")[0]:c.address.state()!==undefined&&!/^\/?$/.test(c.address.state())?
c(k).attr("href").replace(new RegExp("^(.*"+c.address.state()+"|\\.)"),""):c(k).attr("href").replace(/^(#\!?|\.)/,"");c.address.value(i)}}).on("submit",function(i){var k=i.currentTarget;if(c(k).is("form")){i.preventDefault();i=c(k).attr("action");k=s?s.call(k):(i.indexOf("?")!=-1?i.replace(/&$/,""):i+"?")+c(k).serialize();c.address.value(k)}}).data("address",true)});return this}});
